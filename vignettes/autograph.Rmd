---
title: "AutoGraph: Easy control flow for graphs"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{AutoGraph: Easy control flow for graphs}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

AutoGraph helps you write complicated graph code using normal R Behind the scenes, AutoGraph 
automatically transforms your code into the equivalent TensorFlow graph code. AutoGraph 
already supports much of the R language, and that coverage continues to grow. For a 
list of supported R language features, see the Autograph capabilities and 
limitations.

```{r setup}
library(tensorflow)
library(tfautograph)
```


## Automatically convert R control flow

AutoGraph will convert much of the R language into the equivalent TensorFlow graph building code.

AutoGraph converts a function like:

```{r}
square_if_positive <- function(x) {
  if (x > 0){
    x <- x * x
  } else {
   x <- 0 
  }
  x
}
```

To a function that uses graph building:

```{r}
square_if_positive_graph <- autograph(square_if_positive)
square_if_positive_graph(tf$constant(10))
square_if_positive_graph(tf$constant(-10))
```

Note that the pure R function would fail if we passed a Tensor as input:

```{r}
square_if_positive(tf$constant(5))
```

AutoGraph supports common R statements like `while`, `for`, `if`, `break`, and `return`(#TODO), 
with support for nesting. Compare this function with the complicated graph version displayed in the following code blocks:

```{r}
sum_even <- autograph(function(items) {
  s <- 0
  for (i in items) {
    if (i %% 2 <= 0)
      s <- s + i
  }
  s
})

sum_even(tf$constant(list(1,2,3,4)))
```


